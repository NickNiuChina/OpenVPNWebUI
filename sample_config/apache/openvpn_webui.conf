<VirtualHost *:80>
        ServerName sso.digital-service-test.carel-remote.com
        ServerAdmin admin@localhost
        WSGIScriptAlias / /var/www/remote_analytics_webserver/remote_analytics_webserver.wsgi
        ErrorLog ${APACHE_LOG_DIR}/error_remote_analytics_dsvc.log
        LogLevel debug

        SetEnvIf REMOTE_ADDR "(.+)" CLIENTIP=$1
        SetEnvIf X-Forwarded-For "^([0-9.]+)" CLIENTIP=$1
        LogFormat "%v %{CLIENTIP}e %h %l %u %t \"%r\" %>s %D %O \"%{Referer}i\" \"%{User-Agent}i\"" trueip_combined
        CustomLog ${APACHE_LOG_DIR}/access_remote_analytics_dsvc.log trueip_combined

        WSGIApplicationGroup %{GLOBAL}
        WSGIPassAuthorization On
</VirtualHost>

# APACHE config
<VirtualHost *:443>
    ServerAdmin webmaster@djangoblog.com
    ServerName www.djangoblog.com
    ServerAlias djangoblog.com
    #ErrorLog /var/www/djangoblog.com/logs/error.log
    #CustomLog /var/www/djangoblog.com/logs/access.log combined
	
	# daemon mode
	# set venv for a specific app  
    WSGIDaemonProcess djangoblog lang='en_US.UTF-8' locale='en_US.UTF-8' user=www-data group=www-data threads=5 python-home=/opt/venv_djangoblog  python-path=/opt/django/DjangoBlog-master
    WSGIProcessGroup djangoblog
    # serve project in a subdirectory or /
    WSGIScriptAlias /djangoblog /opt/django/DjangoBlog-master/djangoblog/wsgi.py process-group=djangoblog
    # WSGIPythonHome /opt/venv_djangoblog
    # WSGIPythonPath /opt/django/DjangoBlog-master

    <Directory /opt/django/DjangoBlog-master/djangoblog>
    <Files wsgi.py>
   		Require all granted
    </Files>
    </Directory>
    
    # static files
    Alias /robots.txt /path/to/mysite.com/static/robots.txt
    Alias /favicon.ico /path/to/mysite.com/static/favicon.ico

    Alias /media/ /opt/django/DjangoBlog-master/media/
    Alias /static/ /opt/django/DjangoBlog-master/collectedstatic/

    <Directory /opt/django/DjangoBlog-master/collectedstatic>
    Require all granted
    </Directory>

    <Directory /opt/django/DjangoBlog-master/media>
    Require all granted
    </Directory>

    ####################################
    <Location /wssh/ >
            ProxyPass  http://127.0.0.1:8888/
            ProxyPassReverse http://127.0.0.1:8888/
            ProxyPreserveHost On
    # for websocket stuff
            RewriteEngine On
            #RewriteCond %{HTTP:Upgrade}  ^WebSocket$ [NC,OR]
            #RewriteCond %{HTTP:CONNECTION} Upgrade$ [NC,OR]
            RewriteRule /ws* ws://127.0.0.1:8888/ws$1 [P,L]
            # RewriteRule .*  ws://service.carel-remote.com:8888/ws$1 [P,L]
            # RewriteRule .*  ws://service.carel-remote.com/wssh/ws$1 [P,L]
            # RewriteRule ^/?(.*) "ws://https://service.carel-remote.com/wssh/$1" [P,L]
    #RewriteCond %{HTTP:Upgrade} =websocket [NC]
    #RewriteRule /wssh/(.) wss://127.0.0.1:8888/$1 [P,L]
    #RewriteCond %{HTTP:Upgrade} !=websocket [NC]
    #RewriteRule /wssh/(.) http://127.0.0.1:8888/$1 [P,L]
    # rewrite response html to fix paths
            #AddOutputFilterByType SUBSTITUTE text/html
            #Substitute "s|static/js/|/wssh/static/js/|i"
            #Substitute "s|static/css/|/wssh/static/css/|i"
            #Substitute "s|static/img/|/wssh/static/img/|i"
    </Location>


</VirtualHost>